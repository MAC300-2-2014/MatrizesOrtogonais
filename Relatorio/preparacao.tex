\chapter{Método QR}

	\section{Decomposição da matriz A}
	Se A for uma matriz não-singular então é possível decompô-la em um produto de matrizes 
	$QR$, onde $Q$ é ortogonal e $R$ é uma matriz triangular superior de diagonal não-nula. Esta decomposição é única e sempre existe.
	
	Para obter essa decomposição deve-se encontrar uma sequência de $Q_i ^T$, $i~ =~ 1,...,m$ onde m é o número de colunas do sistema, sendo que cada uma dessas $Q_i^T$ transforma cada $i$-ésima coluna em zeros abaixo da $i$-ésima posição, formando assim a matriz triangular superior $R$. Tendo assim que
	
	\[Q_{n-1} ^TQ_{n-2} ^T \ldots Q_{1} ^T A = R\]
	
	Como cada $Q_i ^T$ é ortogonal, temos $A = QR$, onde \[Q = [Q_{n-1} ^T Q_{n-2} ^T \ldots Q_{1} ^T]^T \]\textbf{http://www.sawp.com.br/blog/?p=689}%\cite{sawp}
	\section{Cálculo o vetor x}
	Para resolver um sistema $Ax=b$ podemos decompor a matriz $A$ em termos de $Q$ e $R$ como \[ A = Q{R \brack 0}\] com a matriz $Q$ sendo quadrada de dimensão $n\times n$ e $R$ triangular-superior de dimensão~ $n\times m$.
	A equação toma a forma \[QTx = b\] que pode ser escrito como \[Rx=Q^Tb\]
	Pode-se então separar a solução em dois passos:
	\begin{enumerate}
	\item Calcular $y = Q^Tb$
	\item Resolver o sistema $Rx = y$
	\end{enumerate}
	
	No desenvolvimento do algoritmo não calculou-se explicitamente as matrizes $Q$ e $R$ para aumentar sua eficiência. A forma com que os valores necessários para o cálculo da solução são armazenados e utilizados está descrito no algoritmo para decomposição $QR$.
	
	\section{Reutilização do QR para qualquer b}
	Uma vez calculada a decomposição $QR$ de uma matriz $A$, basta realizar os passos anteriores e obter novas soluções variando apenas os dados de $b$.

	\begin{enumerate}
	\item Calcular $y = Q^Tb$
	\item Resolver o sistema $Rx = y$
	\end{enumerate}
	
	Dessa forma, pode-se reaproveitar todo o processamento das matrizes $QR$ e reduzir o tempo de resolução do algoritmo
	a apenas o cálculo de um produto matriz vetor e uma solução de matriz triangular superior.
	Caso não houvesse esse reaproveitamento, a cada novo vetor de dados $b$ para uma mesma matriz $A$ seriam necessários todos os cálculos para decomposição, o que levaria muito processamento desnecessário.
\chapter{Método dos Quadrados Mínimos}

	\section{Descrição}
	O Método dos Quadrados Mínimos é uma técnica de otimização matemática que procura encontrar o melhor ajuste para um 
	conjunto de dados tentando minimizar a soma dos quadrados das diferenças entre o valor estimado e os dados observados.
	Tais diferenças são chamadas resíduos.
	
	
	Consiste em um estimador que minimiza a soma dos quadrados dos resíduos, de forma a maximizar o grau de ajuste do modelo aos dados observados.\cite{wikipedia}



\chapter{Algoritmo para decomposição QR}
Por questão da otimização de código e eficiência de cálculos, a matriz $Q$ é representada em forma $Q = (I - \gamma uu^T)$. A prova de que a matriz $Q$ pode ser escrita nesta forma está desenvolvida em \cite{watkins}.

A ordem do algoritmo de decomposição QR com posto incompleto consiste em:
\begin{enumerate}
	\item Determinar o elemento de maior valor absoluto $max$ da matriz $A_{nm}$
	\item Multiplicar a matriz A por $\frac{1}{max}$ 
	
	\textbf{Inicia o loop.}
	  \item Calcular/Recalcular a norma das colunas de $A_{nm}$
	  \item Permutar a coluna atual com a coluna de maior norma
	  \item Encontrar a $Q$ e fazer $QA$
	  
	\textbf{Finaliza o loop.}
\end{enumerate}

Os passos 1 e 2 do algoritmo tem por finalidade evitar overflow no cálculo
das normas, uma vez que todos os elementos da matriz, após o passo 2, 
serão <= $\|1\|$ (menor igual a módulo de 1).

A iteração sobre os passos 3 e 4 'empurram' possíveis pivôs nulos para a direita 
da matriz no caso da matriz $A$ possuir posto incompleto. 
As normas ao quadrado de cada coluna são armazenadas em um vetor separadamente. Para
o seu recálculo da iteração~$i$~($i$~>~2), apenas subtrai-se os elementos de cada coluna da 
linha anterior a partir de $i$. Após a permutação da coluna, caso a norma seja equivalente
a zero (menor que um certo epsilon), significa que as submatrizes de $A$ a serem decompostas 
são nulas, uma vez que a maior delas vale zero.

No passo 5, para encontrar a matriz $Q = (I - \gamma uu^T)$, basta apenas encontrar
$\gamma$, $u$ e $\sigma$ (norma de $u$). Não é necessário calcular explicitamente Q. 
Para o produto $QA$ a cada iteração, temos: $QA$ = $A - u  ((\gamma  u^T)  A)$.
Na iteração $i$, como as linhas da coluna $i$ serao zeradas, nestas posições sao armazenadas
o vetor $u$.

\section{Solução dos Mínimos Quadrados com QR}
Dada uma matriz $Ax = b$; $A^{n \times m}$;$ b^{n \times 1}$; $n > m$,
é desejado minimizar  $||r|| = || Ax - b ||$.  Utilizando o fato
de que a matriz Q e ortogonal, tem-se  $|| Ax - b || = || Q^T QRx - Q^Tb || = || Rx - Q^Tb ||$.

Assim, para posto completo minimizar $||r||$ implica em:
$||r|| =  ||c - Rx|| + ||d||$
[formula 3.3.5 p. 229 do livro Watkins]


para posto incompleto:
[p. 233 do livro Watkins, antes do teorema 3.3.12]


onde $x_2$ foi escolhido arbitrariamente como [0 ... 1 ... 1]
                                     indice 1 ... r ... m
				     $r$ = posto de $A$